<Window x:Class="PTRP.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PTRP - Gestione Pazienti"
        Height="600"
        Width="900"
        WindowStartupLocation="CenterScreen"
        Loaded="Window_Loaded">
    <Grid Background="#F5F5F5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header: Ricerca e Comandi -->
        <Border Grid.Row="0" Background="White" Padding="20">
            <StackPanel Orientation="Vertical">
                <TextBlock Text="Ricerca Pazienti" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>

                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <TextBox x:Name="SearchBox"
                             Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged}"
                             Width="300"
                             Height="35"
                             Padding="10"
                             VerticalAlignment="Center"
                             Background="White"
                             Margin="0,0,10,0"/>

                    <Button Command="{Binding SearchPatientsCommand}"
                            Content="Cerca"
                            Width="80"
                            Height="35"
                            Background="#007ACC"
                            Foreground="White"
                            Margin="0,0,5,0"/>

                    <Button Command="{Binding ClearSearchCommand}"
                            Content="Cancella"
                            Width="80"
                            Height="35"
                            Background="#6C757D"
                            Foreground="White"
                            Margin="0,0,10,0"/>
                </StackPanel>

                <!-- Pulsanti di azione -->
                <StackPanel Orientation="Horizontal">
                    <Button Command="{Binding AddPatientCommand}"
                            Content="Aggiungi Paziente"
                            Width="150"
                            Height="35"
                            Background="#28A745"
                            Foreground="White"
                            Margin="0,0,5,0"/>

                    <Button Command="{Binding UpdatePatientCommand}"
                            Content="Modifica"
                            Width="100"
                            Height="35"
                            Background="#FFC107"
                            Foreground="Black"
                            Margin="0,0,5,0"/>

                    <Button Command="{Binding DeletePatientCommand}"
                            Content="Elimina"
                            Width="100"
                            Height="35"
                            Background="#DC3545"
                            Foreground="White"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Lista Pazienti -->
        <DataGrid Grid.Row="1"
                  ItemsSource="{Binding Patients}"
                  SelectedItem="{Binding SelectedPatient}"
                  AutoGenerateColumns="False"
                  Background="White"
                  RowBackground="White"
                  AlternatingRowBackground="#F9F9F9"
                  BorderBrush="#E0E0E0"
                  BorderThickness="1"
                  Margin="20">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                <DataGridTextColumn Header="Nome" Binding="{Binding FirstName}" Width="150"/>
                <DataGridTextColumn Header="Cognome" Binding="{Binding LastName}" Width="150"/>
                <DataGridTextColumn Header="Data Nascita" Binding="{Binding DateOfBirth, StringFormat='dd/MM/yyyy'}" Width="120"/>
                <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="200"/>
                <DataGridTextColumn Header="Telefono" Binding="{Binding PhoneNumber}" Width="120"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Status Bar: Messaggi e Loading -->
        <Border Grid.Row="2" Background="#F0F0F0" Padding="20">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding StatusMessage}"
                           Foreground="#333333"
                           VerticalAlignment="Center"
                           FontSize="12"/>

                <ProgressBar IsIndeterminate="{Binding IsLoading}"
                             Width="100"
                             Height="3"
                             Background="Transparent"
                             Foreground="#007ACC"
                             Margin="10,0,0,0"
                             Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
