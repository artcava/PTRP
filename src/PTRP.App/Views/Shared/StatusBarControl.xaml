<UserControl x:Class="PTRP.App.Views.Shared.StatusBarControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
             Height="32"
             Background="{DynamicResource MaterialDesignPaper}"
             BorderThickness="0,1,0,0"
             BorderBrush="{DynamicResource MaterialDesignDivider}">
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/> <!-- Status Message -->
            <ColumnDefinition Width="*"/>    <!-- Spacer -->
            <ColumnDefinition Width="Auto"/> <!-- Database Status -->
            <ColumnDefinition Width="Auto"/> <!-- Last Sync -->
            <ColumnDefinition Width="Auto"/> <!-- Loading -->
        </Grid.ColumnDefinitions>
        
        <!-- Status Message (with icon) -->
        <StackPanel Grid.Column="0" 
                    Orientation="Horizontal"
                    Margin="12,0,0,0"
                    Visibility="{Binding HasStatusMessage, Converter={StaticResource BooleanToVisibilityConverter}}">
            <md:PackIcon Kind="{Binding StatusIcon}"
                        Width="16"
                        Height="16"
                        Foreground="{Binding StatusIconColor}"
                        VerticalAlignment="Center"
                        Margin="0,0,8,0"/>
            <TextBlock Text="{Binding StatusMessage}"
                      FontSize="12"
                      VerticalAlignment="Center"
                      Foreground="{DynamicResource MaterialDesignBody}"/>
        </StackPanel>
        
        <!-- Spacer -->
        <Border Grid.Column="1"/>
        
        <!-- Database Status -->
        <StackPanel Grid.Column="2" 
                    Orientation="Horizontal"
                    Margin="12,0"
                    ToolTip="{Binding DatabaseStatusTooltip}">
            <md:PackIcon Kind="Database"
                        Width="16"
                        Height="16"
                        Foreground="{Binding DatabaseStatusColor}"
                        VerticalAlignment="Center"
                        Margin="0,0,6,0"/>
            <TextBlock Text="{Binding DatabaseStatus}"
                      FontSize="11"
                      VerticalAlignment="Center"
                      Foreground="{DynamicResource MaterialDesignBody}"/>
        </StackPanel>
        
        <!-- Last Sync Time -->
        <StackPanel Grid.Column="3" 
                    Orientation="Horizontal"
                    Margin="0,0,12,0">
            <md:PackIcon Kind="CloudSync"
                        Width="16"
                        Height="16"
                        VerticalAlignment="Center"
                        Margin="0,0,6,0"
                        Foreground="{DynamicResource MaterialDesignBody}"
                        Opacity="0.6"/>
            <TextBlock Text="{Binding LastSyncTimeDisplay}"
                      FontSize="11"
                      VerticalAlignment="Center"
                      Foreground="{DynamicResource MaterialDesignBody}"
                      Opacity="0.8"/>
        </StackPanel>
        
        <!-- Loading Progress Bar -->
        <ProgressBar Grid.Column="4"
                    Width="100"
                    Height="3"
                    Margin="0,0,12,0"
                    VerticalAlignment="Center"
                    IsIndeterminate="True"
                    Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"
                    Style="{StaticResource MaterialDesignLinearProgressBar}"/>
    </Grid>
</UserControl>
